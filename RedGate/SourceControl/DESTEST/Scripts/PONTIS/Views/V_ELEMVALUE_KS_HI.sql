CREATE OR REPLACE FORCE VIEW pontis.v_elemvalue_ks_hi (elemkey,envkey,elemvalue,s2factor,s3factor,s4factor) AS
(   (  select elemdefs.elemkey as elemkey,         condumdl.envkey as envkey,         condumdl.failagcyco as elemvalue,      case when elemdefs.statecnt = 5 then (3.0/4.0)            else case when elemdefs.statecnt = 4 then (2.0/3.0)               else (1.0/2.0)                    end                          end as s2factor,      case when elemdefs.statecnt = 5 then (2.0/4.0)           else case when elemdefs.statecnt = 4 then (1.0/3.0)               else 0.000                    end                          end as s3factor,      case when elemdefs.statecnt = 5 then (1.0/4.0)            else 0.000                end as s4factor  from condumdl, elemdefs, coptions, scenparam  where condumdl.elemkey = elemdefs.elemkey and        elemdefs.smartflag = '0' and        elemdefs.useparmdls= '0' and        coptions.optionname = 'DEFAULT_SCENARIO' and        scenparam.sckey = coptions.optionval and        scenparam.scparam = 'EW' and        scenparam.scparamvalue = 'FAILCOST' and        mokey = '00'  )  UNION    (   select elemdefs.elemkey as elemkey,         condumdl.envkey as envkey,         condumdl.failagcyco as elemvalue,      case when elemdefs.statecnt = 5 then (3.0/4.0)           else case when elemdefs.statecnt = 4 then (2.0/3.0)               else (1.0/2.0)                    end                          end as s2factor,      case when elemdefs.statecnt = 5 then (2.0/4.0)           else case when elemdefs.statecnt = 4 then (1.0/3.0)               else 0.000                    end                          end as s3factor,      case when elemdefs.statecnt = 5 then (1.0/4.0)            else 0.000                end as s4factor  from condumdl, elemdefs, coptions, scenparam  where condumdl.elemkey = elemdefs.parent and        elemdefs.smartflag = '0' and        elemdefs.useparmdls= '1' and        coptions.optionname = 'DEFAULT_SCENARIO' and        scenparam.sckey = coptions.optionval and        scenparam.scparam = 'EW' and        scenparam.scparamvalue = 'FAILCOST' and        mokey = '00'  )  UNION  (   select elemdefs.elemkey as elemkey,         condumdl.envkey as envkey,         elemdefs.elemweight * (select max(varunitco) from actmodls where         actmodls.elemkey = condumdl.elemkey and actmodls.envkey = condumdl.envkey) as elemvalue,       case when elemdefs.statecnt = 5 then (3.0/4.0)           else case when elemdefs.statecnt = 4 then (2.0/3.0)               else (1.0/2.0)                    end                             end as s2factor,      case when elemdefs.statecnt = 5 then (2.0/4.0)           else case when elemdefs.statecnt = 4 then (1.0/3.0)               else 0.000                    end                          end as s3factor,      case when elemdefs.statecnt = 5 then (1.0/4.0)          else 0.000                end as s4factor  from condumdl, elemdefs, coptions, scenparam  where condumdl.elemkey = elemdefs.elemkey and        elemdefs.smartflag = '0' and        elemdefs.useparmdls='0' and        coptions.optionname = 'DEFAULT_SCENARIO' and        scenparam.sckey = coptions.optionval and        scenparam.scparam = 'EW' and        scenparam.scparamvalue <> 'FAILCOST' and        mokey = '00'  )  UNION  (  select elemdefs.elemkey as elemkey,         condumdl.envkey as envkey,         elemdefs.elemweight * (select max(varunitco) from actmodls where         actmodls.elemkey = condumdl.elemkey and actmodls.envkey = condumdl.envkey) as elemvalue,      case when elemdefs.statecnt = 5 then (3.0/4.0)            else case when elemdefs.statecnt = 4 then (2.0/3.0)               else (1.0/2.0)                    end                          end as s2factor,      case when elemdefs.statecnt = 5 then (2.0/4.0)           else case when elemdefs.statecnt = 4 then (1.0/3.0)               else 0.000                    end                          end as s3factor,     case when elemdefs.statecnt = 5 then (1.0/4.0)        else 0.000              end as s4factor  from  condumdl, elemdefs, coptions, scenparam  where condumdl.elemkey = elemdefs.parent and        elemdefs.smartflag = '0' and        elemdefs.useparmdls= '1' and        coptions.optionname = 'DEFAULT_SCENARIO' and        scenparam.sckey = coptions.optionval and        scenparam.scparam = 'EW' and        scenparam.scparamvalue <> 'FAILCOST' and        mokey = '00'  ))

 ;